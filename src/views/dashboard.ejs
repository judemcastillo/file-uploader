<%- include('partials/header', { title: 'Dashboard' }) %> <%-
include('partials/breadcrumb', { breadcrumbs: [] }) %>
<!-- shows: My Drive -->
<h2>My Drive</h2>

<% if (error) { %>
<p style="color: red"><%= error %></p>
<% } %>

<!-- Root folders -->

<ul class="foldersList">
	<h3 style="margin-top: 1rem">Folders</h3>
	<% rootFolders.forEach(f => { %>
	<li class="folders">
		<a href="/folders/<%= f.id %>"><%= f.name %></a>
		<form
			action="/folders/<%= f.id %>/delete"
			method="post"
			style="display: inline"
		>
			<button>Delete</button>
		</form>
	</li>
	<% }) %> <% if (!rootFolders.length) { %>
	<li>(No folders yet)</li>
	<% } %>
</ul>

<!-- Create a root-level folder -->
<%- include('partials/new_folder_button', { parentId: null, error }) %>

<!-- Root files -->
<h3>Files in My Drive</h3>
<ul>
	<% rootFiles.forEach(file => { %>
	<li>
		<a href="/files/<%= file.id %>"><%= file.originalName %></a>
		<small
			>• <%= (file.size/1024).toFixed(1) %> KB • <%= new
			Date(file.createdAt).toLocaleString() %>
		</small>
	</li>
	<!-- Share button -->
	<form action="/share" method="post" style="display: inline">
		<input type="hidden" name="type" value="file" />
		<input type="hidden" name="id" value="<%= file.id %>" />
		<input type="hidden" name="duration" value="1d" />
		<button type="submit">Share</button>
	</form>
	<form
		action="/files/<%= file.id %>/delete"
		method="post"
		style="display: inline"
		onsubmit="return confirm('Delete this file?');"
	>
		<button>Delete</button>
	</form>
	<% }) %> <% if (!rootFiles.length) { %>
	<li>(No files at root)</li>
	<% } %>
</ul>

<!-- Upload directly to My Drive (root) -->
<h3 style="margin-top: 1rem">Upload to My Drive</h3>
<form action="/files/upload" method="post" enctype="multipart/form-data">
	<!-- no folderId = goes to root -->
	<input type="file" name="file" required />
	<button type="submit">Upload</button>
</form>
